import{useRef as e,useCallback as n,useEffect as o,useState as r}from"react";import{jsx as t}from"react/jsx-runtime";function i(r){var t=r.redirectUri,i=r.clientId,a=r.onSuccess,c=r.onError,s=r.scope,d=void 0===s?"r_emailaddress":s,l=r.state,u=void 0===l?"":l,w=r.Browser,f=e(null),g=n((function(e){var n=localStorage.getItem("linkedin_oauth2_state");if(e.origin===window.location.origin)if(e.data.errorMessage&&"Linked In"===e.data.from){if(e.data.state!==n)return void w.close();c&&c(e.data),w.close()}else if(e.data.code&&"Linked In"===e.data.from){if(e.data.state!==n)return void w.close();a&&a(e.data.code),w.close()}}),[c,a]);o((function(){return function(){window.removeEventListener("message",g,!1),w.close(),f.current&&(window.clearInterval(f.current),f.current=null)}}),[g]),o((function(){return window.addEventListener("message",g,!1),function(){window.removeEventListener("message",g,!1)}}),[g]);var p=function(){var e="&scope="+encodeURI(d),n=u||function(e){void 0===e&&(e=20);for(var n="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=o.length,t=0;t<e;t++)n+=o.charAt(Math.floor(Math.random()*r));return n}();return localStorage.setItem("linkedin_oauth2_state",n),"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id="+i+"&redirect_uri="+t+e+"&state="+n};return{linkedInLogin:function(){w.close(),w.open({url:p()}),f.current&&(window.clearInterval(f.current),f.current=null)}}}function a(e){return(0,e.children)({linkedInLogin:i({redirectUri:e.redirectUri,clientId:e.clientId,onSuccess:e.onSuccess,onError:e.onError,state:e.state,scope:e.scope,closePopupMessage:e.closePopupMessage}).linkedInLogin})}function c(){var e=r(""),n=e[0],i=e[1];return o((function(){var e=function(e){for(var n=e.substring(1).split("&"),o={},r=0;r<n.length;r++){var t=n[r].split("=");t.length>1&&(o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]))}return o}(window.location.search);if(e.state!==localStorage.getItem("linkedin_oauth2_state"))i("State does not match");else if(e.error){var n=e.error_description||"Login failed. Please try again.";window.opener&&window.opener.postMessage({error:e.error,state:e.state,errorMessage:n,from:"Linked In"},window.location.origin),"user_cancelled_login"===e.error&&window.close()}e.code&&window.opener&&window.opener.postMessage({code:e.code,state:e.state,from:"Linked In"},window.location.origin)}),[]),t("div",{children:n},void 0)}export{a as LinkedIn,c as LinkedInCallback,i as useLinkedIn};
//# sourceMappingURL=index.esm.js.map
