"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),n=require("react/jsx-runtime");function r(n){var r=n.redirectUri,t=n.clientId,o=n.onSuccess,i=n.onError,a=n.scope,s=void 0===a?"r_emailaddress":a,c=n.state,d=void 0===c?"":c,l=n.Browser,u=e.useRef(null),f=e.useCallback((function(e){var n=localStorage.getItem("linkedin_oauth2_state");if(e.origin===window.location.origin)if(e.data.errorMessage&&"Linked In"===e.data.from){if(e.data.state!==n)return void l.close();i&&i(e.data),l.close()}else if(e.data.code&&"Linked In"===e.data.from){if(e.data.state!==n)return void l.close();o&&o(e.data.code),l.close()}}),[i,o]);e.useEffect((function(){return function(){window.removeEventListener("message",f,!1),l.close(),u.current&&(window.clearInterval(u.current),u.current=null)}}),[f]),e.useEffect((function(){return window.addEventListener("message",f,!1),function(){window.removeEventListener("message",f,!1)}}),[f]);var w=function(){var e="&scope="+encodeURI(s),n=d||function(e){void 0===e&&(e=20);for(var n="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=r.length,o=0;o<e;o++)n+=r.charAt(Math.floor(Math.random()*t));return n}();return localStorage.setItem("linkedin_oauth2_state",n),"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id="+t+"&redirect_uri="+r+e+"&state="+n};return{linkedInLogin:function(){l.close(),l.open({url:w()}),u.current&&(window.clearInterval(u.current),u.current=null)}}}exports.LinkedIn=function(e){return(0,e.children)({linkedInLogin:r({redirectUri:e.redirectUri,clientId:e.clientId,onSuccess:e.onSuccess,onError:e.onError,state:e.state,scope:e.scope,closePopupMessage:e.closePopupMessage}).linkedInLogin})},exports.LinkedInCallback=function(){var r=e.useState(""),t=r[0],o=r[1];return e.useEffect((function(){var e=function(e){for(var n=e.substring(1).split("&"),r={},t=0;t<n.length;t++){var o=n[t].split("=");o.length>1&&(r[decodeURIComponent(o[0])]=decodeURIComponent(o[1]))}return r}(window.location.search);if(e.state!==localStorage.getItem("linkedin_oauth2_state"))o("State does not match");else if(e.error){var n=e.error_description||"Login failed. Please try again.";window.opener&&window.opener.postMessage({error:e.error,state:e.state,errorMessage:n,from:"Linked In"},window.location.origin),"user_cancelled_login"===e.error&&window.close()}e.code&&window.opener&&window.opener.postMessage({code:e.code,state:e.state,from:"Linked In"},window.location.origin)}),[]),n.jsx("div",{children:t},void 0)},exports.useLinkedIn=r;
//# sourceMappingURL=index.js.map
