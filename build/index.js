"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("react/jsx-runtime");function n(r){var n=r.redirectUri,t=r.clientId,o=r.onSuccess,i=r.onError,a=r.scope,c=void 0===a?"r_emailaddress":a,s=r.state,d=void 0===s?"":s,u=r.Browser,l=e.useRef(null),f=e.useCallback((function(e){var r=localStorage.getItem("linkedin_oauth2_state");if(e.origin===window.location.origin)if(e.data.errorMessage&&"Linked In"===e.data.from){if(e.data.state!==r)return void u.close();i&&i(e.data),u.close()}else if(e.data.code&&"Linked In"===e.data.from){if(e.data.state!==r)return void u.close();o&&o(e.data.code),u.close()}}),[u,i,o]);e.useEffect((function(){return function(){window.removeEventListener("message",f,!1),u.close(),l.current&&(window.clearInterval(l.current),l.current=null)}}),[u,f]),e.useEffect((function(){return window.addEventListener("message",f,!1),function(){window.removeEventListener("message",f,!1)}}),[f]);var w=function(){var e="&scope="+encodeURI(c),r=d||function(e){void 0===e&&(e=20);for(var r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,o=0;o<e;o++)r+=n.charAt(Math.floor(Math.random()*t));return r}();return localStorage.setItem("linkedin_oauth2_state",r),"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id="+t+"&redirect_uri="+n+e+"&state="+r};return{linkedInLogin:function(){u.close(),u.open({url:w()}),l.current&&(window.clearInterval(l.current),l.current=null)}}}function t(r){var n=r.redirectUri,t=r.clientId,o=r.onSuccess,i=r.onError,a=r.scope,c=void 0===a?"r_emailaddress":a,s=r.state,d=void 0===s?"":s,u=r.closePopupMessage,l=void 0===u?"User closed the popup":u,f=e.useRef(null),w=e.useRef(null),v=e.useCallback((function(e){var r=localStorage.getItem("linkedin_oauth2_state");if(e.origin===window.location.origin)if(e.data.errorMessage&&"Linked In"===e.data.from){if(e.data.state!==r)return void(f.current&&f.current.close());i&&i(e.data),f.current&&f.current.close()}else if(e.data.code&&"Linked In"===e.data.from){if(e.data.state!==r)return void(f.current&&f.current.close());o&&o(e.data.code),f.current&&f.current.close()}}),[i,o]);e.useEffect((function(){return function(){window.removeEventListener("message",v,!1),f.current&&(f.current.close(),f.current=null),w.current&&(window.clearInterval(w.current),w.current=null)}}),[v]),e.useEffect((function(){return window.addEventListener("message",v,!1),function(){window.removeEventListener("message",v,!1)}}),[v]);var g=function(){var e="&scope="+encodeURI(c),r=d||function(e){void 0===e&&(e=20);for(var r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,o=0;o<e;o++)r+=n.charAt(Math.floor(Math.random()*t));return r}();return localStorage.setItem("linkedin_oauth2_state",r),"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id="+t+"&redirect_uri="+n+e+"&state="+r};return{linkedInLogin:function(){var e;null===(e=f.current)||void 0===e||e.close(),f.current=window.open(g(),"_blank",function(e){var r=e.width,n=void 0===r?600:r,t=e.height,o=void 0===t?600:t;return"left="+(screen.width/2-n/2)+",top="+(screen.height/2-o/2)+",width="+n+",height="+o}({width:600,height:600})),w.current&&(window.clearInterval(w.current),w.current=null),w.current=window.setInterval((function(){try{f.current&&f.current.closed&&(window.clearInterval(w.current),w.current=null,i&&i({error:"user_closed_popup",errorMessage:l}))}catch(e){window.clearInterval(w.current),w.current=null}}),1e3)}}}function o(e){var r=!!e.Browser,o=n(e),i=t(e);return{linkedInLogin:r?o:i}}exports.LinkedIn=function(e){return(0,e.children)({linkedInLogin:o({redirectUri:e.redirectUri,clientId:e.clientId,onSuccess:e.onSuccess,onError:e.onError,state:e.state,scope:e.scope,closePopupMessage:e.closePopupMessage}).linkedInLogin})},exports.LinkedInCallback=function(){var n=e.useState(""),t=n[0],o=n[1];return e.useEffect((function(){var e=function(e){for(var r=e.substring(1).split("&"),n={},t=0;t<r.length;t++){var o=r[t].split("=");o.length>1&&(n[decodeURIComponent(o[0])]=decodeURIComponent(o[1]))}return n}(window.location.search);if(e.state!==localStorage.getItem("linkedin_oauth2_state"))o("State does not match");else if(e.error){var r=e.error_description||"Login failed. Please try again.";window.opener&&window.opener.postMessage({error:e.error,state:e.state,errorMessage:r,from:"Linked In"},window.location.origin),"user_cancelled_login"===e.error&&window.close()}e.code&&window.opener&&window.opener.postMessage({code:e.code,state:e.state,from:"Linked In"},window.location.origin)}),[]),r.jsx("div",{children:t},void 0)},exports.useLinkedIn=o;
//# sourceMappingURL=index.js.map
