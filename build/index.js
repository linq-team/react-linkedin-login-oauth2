"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@capacitor/browser"),o=require("react/jsx-runtime");function n(o){var n=o.redirectUri,t=o.clientId,i=o.onSuccess,s=o.onError,a=o.scope,c=void 0===a?"r_emailaddress":a,d=o.state,l=void 0===d?"":d,u=e.useRef(null),w=e.useCallback((function(e){var o=localStorage.getItem("linkedin_oauth2_state");if(e.origin===window.location.origin)if(e.data.errorMessage&&"Linked In"===e.data.from){if(e.data.state!==o)return void r.Browser.close();s&&s(e.data),r.Browser.close()}else if(e.data.code&&"Linked In"===e.data.from){if(e.data.state!==o)return void r.Browser.close();i&&i(e.data.code),r.Browser.close()}}),[s,i]);e.useEffect((function(){return function(){window.removeEventListener("message",w,!1),r.Browser.close(),u.current&&(window.clearInterval(u.current),u.current=null)}}),[w]),e.useEffect((function(){return window.addEventListener("message",w,!1),function(){window.removeEventListener("message",w,!1)}}),[w]);var f=function(){var e="&scope="+encodeURI(c),r=l||function(e){void 0===e&&(e=20);for(var r="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=o.length,t=0;t<e;t++)r+=o.charAt(Math.floor(Math.random()*n));return r}();return localStorage.setItem("linkedin_oauth2_state",r),"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id="+t+"&redirect_uri="+n+e+"&state="+r};return{linkedInLogin:function(){r.Browser.close(),r.Browser.open({url:f()}),u.current&&(window.clearInterval(u.current),u.current=null)}}}exports.LinkedIn=function(e){return(0,e.children)({linkedInLogin:n({redirectUri:e.redirectUri,clientId:e.clientId,onSuccess:e.onSuccess,onError:e.onError,state:e.state,scope:e.scope,closePopupMessage:e.closePopupMessage}).linkedInLogin})},exports.LinkedInCallback=function(){var r=e.useState(""),n=r[0],t=r[1];return e.useEffect((function(){var e=function(e){for(var r=e.substring(1).split("&"),o={},n=0;n<r.length;n++){var t=r[n].split("=");t.length>1&&(o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]))}return o}(window.location.search);if(e.state!==localStorage.getItem("linkedin_oauth2_state"))t("State does not match");else if(e.error){var r=e.error_description||"Login failed. Please try again.";window.opener&&window.opener.postMessage({error:e.error,state:e.state,errorMessage:r,from:"Linked In"},window.location.origin),"user_cancelled_login"===e.error&&window.close()}e.code&&window.opener&&window.opener.postMessage({code:e.code,state:e.state,from:"Linked In"},window.location.origin)}),[]),o.jsx("div",{children:n},void 0)},exports.useLinkedIn=n;
//# sourceMappingURL=index.js.map
